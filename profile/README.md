# Phone Dashboard

Phone Dashboard is a mobile application and suopporting cloud-based data server that allows researchers to track active application usage on Android devices and to implement behavioral interventions to try and change user behavior.

It was originally developed to support the research aims of Hunt Allcott, Matthew Gentzkow, and Lena Song, resulting [the National Bureau of Economic Research working paper on Digital Addiction](https://www.nber.org/papers/w28936). As such, its design and implementation reflects thats study's approach and design.

## Phone Dashboard Mobile App

The source code for the mobile app is located in the [Phone-Dashboard-Android](https://github.com/lenasong/Phone-Dashboard-Android) repository and this consists of the full Android project needed to build the app. Refer to that repository's README for build instructions.

## Phone Dashboard Data Collection Server

The Android mobile app relies on a cloud-based data collection server for retrieving its configuration periodically (such as whether to apply an intevention or not, and where to transmit gathered data). The server code and installation instructions are available in the [Phone-Dashboard-Django](https://github.com/lenasong/Phone-Dashboard-Django) repository.

## Experimental Setup

Users entering a Phone Dashboard study are typically instructed to install the app from the Google Play app store.

When the app is installed and the user runs it for the first time, they are prompted for their e-mail address, which is transmitted to the cloud server. The cloud server checks that e-mail address against a list of prior enrollments and returns the study identifier if the user had previously enrolled with that address or generates a new unique study identifier if this is the user's first time using the app. On the server, e-mail addresses are not stored in their raw forms, but are instead stored (and compared against) as cryptographic hashes, in order prevent any unnecessary personally-identifiable information from being retained.

When the server responds to the app's enrollemnt request, in addition to returning the study identifier - which is the only identifier used to tag data originating from the device - it also returns a configuration document that the app interprets to set itself up as needed for the study design. When a network is available, the device periodically queries the server typically every five minutes or so for configuration updates, so that the app can change its behavior to accomodate scheduled changes in the study design.

This configuration document is encoded in JSON. An example:

```javascript
{
  "identifier": "123456789",
  "fetch_date": "2024-05-09",
  "start_date": "2023-10-11",
  "calculation_start": "2023-10-12",
  "prior_start_date": "2023-10-10",
  "treatment_active": true,
  "blocker_type": "flexible_snooze",
  "snooze_delay": 5,
  "initial_snooze_amount": 10.0,
  "snoozes": [],
  "apps": [
    {
      "original_package": "com.android.chrome",
      "sort_order": 0,
      "replacement_package": "browser"
    },
    {
      "original_package": "org.mozilla.firefox",
      "sort_order": 0,
      "replacement_package": "browser"
    },
    {
      "original_package": "com.facebook.katana",
      "sort_order": 0,
      "replacement_package": "facebook"
    },
    {
      "original_package": "com.facebook.orca",
      "sort_order": 0,
      "replacement_package": "facebook"
    },
    {
      "original_package": "com.whatsapp",
      "sort_order": 0
    },
    {
      "original_package": "com.zhiliaoapp.musically",
      "sort_order": 0
    }
  ]
}
```

The `identifier` and `fetch_date` keys indicate the user's study identifier and the date when the configuration was fetched (for later diagnostic purposes if needed) and are automatically generated by the server. The `start_date`, `prior_start_date`, and `calculation_start` parameters are calculated based on whether the user is currently in a specific treatment arm and are used for calculating usage statistics for that period.

The `treatment_active`, `blocker_type`, `receives_subsidy`, `snooze_delay`, and `initial_snooze_amount` parameters configure the intervention on the device.

The `treatment_active` option (values, `true` or `false`) enables and disables the intervention completely.

The `blocker_type` option sets the type of the intervention based on a set of possible values. `free_snooze` allows user to "snooze" (temporarily disable) blocks for not cost. `costly_snooze` temporarily disables blocks, but for a cost. `flexible_snooze` behaves the same as `costly_snooze`, but the snooze length is set by the participant, not the study staff. `no_snooze` disables the snooze option altogether, and particiants are not alloed to use the blocked app until the next calendar day.

The `snooze_delay` option sets the length of time (in minutes) that a participant can temporarily unblock an app set by the study staff. It is not uses when `blocker_type` is `flexible_snooze`.

The `initial_snooze_amount` option indicate the available compensation budget for the participant to purchase temporary app unblocks in the `costly_snooze` and `flexible_snooze` conditions. Once that budget is exhausted, participants can no longer purchase snoozes to get around the app block.

The `snoozes` option is an automatic parameter generated by the data server that lists the existing snoozes already purchased. This is implemented to prevent participants from resetting their snooze budgets by uninstalling the app and reinstalling it.

The `apps` data structure is a list of apps that are subject to the experiment. The `original_package` field indicates the specific app package name to be monitored. `com.android.chrome` is the Chrome web browser. The `sort_order` parameter overrides the default usage-based search order in the mobile app interface - this allows the study staff to highlight specfic apps even when their usage falls below other apps not of experimental interest. Finally, the `replacement_package` parameter is an identifier that groups specific apps together for the purposes of the experiment. In the example above, both `com.facebook.katana` (Facebook) and `com.facebook.orca` (Facebook Messenger) are grouped together as `facebook`. These apps will share a usage budget for blocking purposes instead of having their own independent budgets.

These parameters are set on a per-participant basis as *Treatment Phase* objects in the cloud server:

![Treatment Phase Example](https://github.com/Phone-Dashboard/.github/assets/1141048/393c238e-827c-4451-841b-c6eb976e5761)

Refer to the data collection server documentation for details.

## Data Collection

Once the Phone Dashboard mobile app is configured for use, it uses [the Passive Data Kit (PDK) Android framework](https://github.com/audacious-software/PassiveDataKit-Android) to continually gather usage information from the device. The app stores that information in a device-local database, and when network connectivity is available, that data is transmitted to the corresponding [PDK server components](https://github.com/audacious-software/PassiveDataKit-Django) on the data collection server. A copy of the data is retained on the device for the purposes generating the display showing app usage and available snooze budgets (if enabled).

The mobile app implements additional study-specific data types (called *generators* in PDK) for recording and transmitting direct app interactions, usage summaries, and other operational details requested by the study staff. This is all transmitted to the data collection server in the same manner as other native PDK data types and can be inspected and exported from the data collection server (see that component's documentation for details).

## Questions?

This is an early initial version of this documentation, so if you have any questions or a topic was left unaddressed, please direct those inquiries to [chris@audacious-software.com](mailto:chris@audacious-software.com).
